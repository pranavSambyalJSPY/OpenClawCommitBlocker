version: 1
score:
  min: 0
  max: 100
  clamp: true
  default_block_threshold: 50
  bands:
    low:
      min: 0
      max: 29
    medium:
      min: 30
      max: 69
    high:
      min: 70
      max: 100

signals:
  commit_metadata.author_email_domain:
    enabled: true
    category: commit_metadata_patterns
    weight: 18
    false_positive_risk: medium
    extraction:
      type: email_domain_match
      denylist_domains: []
      denylist_regex: []

  commit_metadata.unusual_timestamp:
    enabled: true
    category: commit_metadata_patterns
    weight: 8
    false_positive_risk: high
    extraction:
      type: local_hour_window
      unusual_hours: [0, 1, 2, 3, 4, 5]
      compare_to_repo_baseline: true

  commit_metadata.commit_burst:
    enabled: true
    category: commit_metadata_patterns
    weight: 14
    false_positive_risk: medium
    extraction:
      type: burst_detection
      commits_in_window: 4
      window_minutes: 20
      require_low_file_diversity: true

  message.agentic_phrases:
    enabled: true
    category: message_residue
    weight: 16
    false_positive_risk: low_medium
    extraction:
      type: regex_any
      patterns:
        - '(?i)generated by'
        - '(?i)as an ai'
        - '(?i)automated update'
        - '(?i)co-authored-by:\\s*ai'
        - '(?i)apply patch'

  message.templated_structure:
    enabled: true
    category: message_residue
    weight: 7
    false_positive_risk: medium
    extraction:
      type: repeated_template_sections
      required_sections: [summary, testing, notes]
      min_repetitions: 3

  diff.unrelated_large_refactor:
    enabled: true
    category: diff_residue
    weight: 20
    false_positive_risk: medium
    extraction:
      type: scope_divergence
      max_unrelated_file_ratio: 0.35
      min_total_files_changed: 8

  diff.repetitive_mechanical_edits:
    enabled: true
    category: diff_residue
    weight: 12
    false_positive_risk: low_medium
    extraction:
      type: repeated_edit_pattern
      min_files_with_same_hunk_shape: 6
      max_semantic_variance: 0.25

  diff.todo_placeholders:
    enabled: true
    category: diff_residue
    weight: 9
    false_positive_risk: high
    extraction:
      type: added_placeholder_tokens
      tokens: [TODO, FIXME, TBD, 'fill this in']
      require_issue_reference: false

  pr.boilerplate_ai_summary:
    enabled: true
    category: pr_template_residue
    weight: 11
    false_positive_risk: medium
    extraction:
      type: boilerplate_phrase_density
      phrases:
        - 'This PR introduces'
        - 'Key changes include'
        - 'No functional changes intended'
      min_phrase_matches: 2
      require_low_specificity: true

  pr.checklist_without_evidence:
    enabled: true
    category: pr_template_residue
    weight: 10
    false_positive_risk: medium_high
    extraction:
      type: checklist_consistency
      require_marked_complete: true
      required_evidence_fields: [test_evidence, issue_link]
      allow_missing_screenshot_for_backend_only: true
