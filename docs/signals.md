# Signal Taxonomy and Scoring

This document defines default heuristic signals for identifying potentially agent-authored changesets. Signals are grouped by category, each with an extraction rule, confidence impact, and expected false-positive risk.

## Scoring model

- **Score range:** `0-100`
- **Computation:** sum all matched signal weights, clamp to `[0, 100]`
- **Default decision threshold:** `50` (configurable)

### Risk bands

| Band | Score range | Meaning |
|---|---:|---|
| `low` | `0-29` | Mostly human-like residue or insufficient evidence. |
| `medium` | `30-69` | Mixed evidence; review recommended before blocking. |
| `high` | `70-100` | Strong aggregate residue; likely automation/agent involvement. |

---

## 1) Commit metadata patterns

### 1.1 Suspicious author/email domain
- **Extraction rule:** match commit author email domain against a configurable denylist (for example, disposable domains, known automation domains) or explicit regex patterns.
- **Confidence impact (weight):** `+18`
- **Expected false-positive risk:** `medium` (legitimate bots and CI users may overlap)

### 1.2 Unusual commit timestamp
- **Extraction rule:** mark when local commit hour falls in configured unusual windows (for example, `00:00-05:00`) and diverges from repo/team historical baseline.
- **Confidence impact (weight):** `+8`
- **Expected false-positive risk:** `high` (distributed teams, travel, and night work are common)

### 1.3 Commit burst pattern
- **Extraction rule:** detect `N` or more commits by same author within `T` minutes, especially with low per-commit file diversity.
- **Confidence impact (weight):** `+14`
- **Expected false-positive risk:** `medium` (interactive rebasing, fixup workflows can resemble bursts)

---

## 2) Message residue

### 2.1 Agentic phrase markers in commit messages
- **Extraction rule:** regex/substring matching for phrases frequently seen in agent outputs (examples: "generated by", "as an AI", "automated update", "co-authored-by: ai", "apply patch").
- **Confidence impact (weight):** `+16`
- **Expected false-positive risk:** `low-medium` (can appear in quoted text or policy docs)

### 2.2 Over-structured summary format
- **Extraction rule:** detect repeated templated structure in messages (for example, rigid "Summary/Testing/Notes" patterns across many commits from same author).
- **Confidence impact (weight):** `+7`
- **Expected false-positive risk:** `medium` (teams may enforce templates intentionally)

---

## 3) Diff residue

### 3.1 Large unrelated refactor mixed with requested change
- **Extraction rule:** high ratio of touched files outside requested scope, or significant churn in modules not referenced by issue/PR metadata.
- **Confidence impact (weight):** `+20`
- **Expected false-positive risk:** `medium` (cleanup/refactor waves are sometimes intentional)

### 3.2 Repetitive mechanical edits
- **Extraction rule:** repeated near-identical edits across many files (for example, same token substitution/hygiene pass) with low semantic variance.
- **Confidence impact (weight):** `+12`
- **Expected false-positive risk:** `low-medium` (bulk codemods can be legitimate)

### 3.3 TODO placeholder residue
- **Extraction rule:** newly introduced placeholder text patterns such as `TODO`, `FIXME`, `TBD`, "fill this in", or generic scaffold comments without linked issue IDs.
- **Confidence impact (weight):** `+9`
- **Expected false-positive risk:** `high` (humans frequently leave TODOs)

---

## 4) PR-template residue

### 4.1 Boilerplate AI-like PR summaries
- **Extraction rule:** detect stock phrasing patterns in PR body (for example, "This PR introduces", "Key changes include", "No functional changes intended") combined with low specificity.
- **Confidence impact (weight):** `+11`
- **Expected false-positive risk:** `medium` (many teams use similar boilerplate)

### 4.2 Checklist completion without concrete evidence
- **Extraction rule:** PR template checklists marked complete while linked evidence (tests, screenshots, issue links) is missing or inconsistent.
- **Confidence impact (weight):** `+10`
- **Expected false-positive risk:** `medium-high` (can be process sloppiness rather than automation)

---

## Aggregation notes

- Signals are intentionally **heuristic** and should not be treated as proof.
- Consumers should tune weights and thresholds by repository baseline and can disable specific noisy signals.
- Recommended policy: block only in `high`, require review in `medium`, allow in `low`.
